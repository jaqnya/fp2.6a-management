*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 10/20/04            FSTPRMFY.PRG               17:03:55 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2004 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

m.currarea = SELECT()


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("_1cy10ks5o")
	DEFINE WINDOW _1cy10ks5o ;
		FROM INT((SROW()-15)/2),INT((SCOL()-65)/2) ;
		TO INT((SROW()-15)/2)+14,INT((SCOL()-65)/2)+64 ;
		TITLE " MODIFICACION DE LISTAS DE PRECIOS " ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              FSTPRMFY/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("_1cy10ks5o")
	ACTIVATE WINDOW _1cy10ks5o SAME
ELSE
	ACTIVATE WINDOW _1cy10ks5o NOSHOW
ENDIF
@ 6,18 SAY "1) Aumento por Porcentaje en el Precio." ;
	SIZE 1,39, 0
@ 7,18 SAY "2) Disminuciўn por Porcentaje en el Precio." ;
	SIZE 1,43, 0
@ 9,2 SAY "PORCENTAJE:" ;
	SIZE 1,11, 0
@ 6,2 SAY "OPCION....:" ;
	SIZE 1,11, 0
@ 4,2 SAY "MARCA.....:" ;
	SIZE 1,11, 0
@ 3,2 SAY "SUB-RUBRO.:" ;
	SIZE 1,11, 0
@ 2,2 SAY "RUBRO.....:" ;
	SIZE 1,11, 0
@ 1,2 SAY "PROVEEDOR.:" ;
	SIZE 1,11, 0
@ 8,2 SAY "LISTAS....:" ;
	SIZE 1,11, 0
@ 8,14 SAY "1    2    3    4    5" ;
	SIZE 1,21, 0
@ 10,0 TO 10,62
@ 1,14 GET mproveedor ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "@K 9999" ;
	VALID _1cy10ks5w()
@ 2,14 GET mrubro ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "@K 9999" ;
	VALID _1cy10ks61()
@ 3,14 GET msubrubro ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "@K 9999" ;
	VALID _1cy10ks66()
@ 4,14 GET mmarca ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "@K 9999" ;
	VALID _1cy10ks6b()
@ 6,14 GET mopcion ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@K 9999" ;
	VALID _1cy10ks6g()
@ 8,16 GET mlista1 ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@A!K" ;
	VALID _1cy10ks6h()
@ 8,21 GET mlista2 ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@A!K" ;
	VALID _1cy10ks6j()
@ 8,26 GET mlista3 ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@A!K" ;
	VALID _1cy10ks6k()
@ 8,31 GET mlista4 ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@A!K" ;
	VALID _1cy10ks6m()
@ 8,36 GET mlista5 ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@A!K" ;
	VALID _1cy10ks6n()
@ 9,14 GET mporcentaje ;
	SIZE 1,7 ;
	DEFAULT 0 ;
	PICTURE "@K 999.99" ;
	VALID _1cy10ks6o()
@ 11,17 GET cmgChoice ;
	PICTURE "@*HT \!\<Iniciar;\?\<Cancelar" ;
	SIZE 1,12,5 ;
	DEFAULT 1 ;
	VALID _1cy10ks6p()

IF NOT WVISIBLE("_1cy10ks5o")
	ACTIVATE WINDOW _1cy10ks5o
ENDIF

READ CYCLE

RELEASE WINDOW _1cy10ks5o
SELECT (m.currarea)


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є  FSTPRMFY/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE Process

*-- Base de datos, Ўndices, relaciones.
SELECT 0
temp01 = "tm" + RIGHT(SYS(3), 6) + ".dbf"
CREATE TABLE &temp01 (codigo     C(15) ,;
                      codigo2    C(15) ,;
                      codorig    C(15) ,;
                      nombre     C(40) ,;
                      pventag1   N(13,4) ,;
                      pventag2   N(13,4) ,;
                      pventag3   N(13,4) ,;
                      pventag4   N(13,4) ,;
                      pventag5   N(13,4) ,;
                      pventad1   N(13,4) ,;
                      pventad2   N(13,4) ,;
                      pventad3   N(13,4) ,;
                      pventad4   N(13,4) ,;
                      pventad5   N(13,4))

USE &temp01 ALIAS temporal EXCLUSIVE

cScope = ""

IF .NOT. EMPTY(mproveedor)
   cScope = "proveedor = " + ALLTRIM(mproveedor)
ENDIF

IF .NOT. EMPTY(mrubro)
   IF .NOT. EMPTY(cScope)
      cScope = cScope + " .AND. "
   ENDIF

   cScope = cScope + "rubro = " + ALLTRIM(mrubro)
ENDIF

IF .NOT. EMPTY(msubrubro)
   IF .NOT. EMPTY(cScope)
      cScope = cScope + " .AND. "
   ENDIF

   cScope = cScope + "subrubro = " + ALLTRIM(msubrubro)
ENDIF

IF .NOT. EMPTY(mmarca)
   IF .NOT. EMPTY(cScope)
      cScope = cScope + " .AND. "
   ENDIF

   cScope = cScope + "marca = " + ALLTRIM(mmarca)
ENDIF

* Programa principal
SELECT maesprod
SET ORDER TO indice2 OF maesprod.cdx

GO TOP

SCAN ALL
   IF EVAL(cScope)
      IF mlista1 = "X"
         mpventad1 = ROUND(maesprod.pventag1 * (1 + mporcentaje / 100), 0)
      ELSE
         mpventad1 = maesprod.pventag1
      ENDIF

      IF mlista2 = "X"
         mpventad2 = ROUND(maesprod.pventag2 * (1 + mporcentaje / 100), 0)
      ELSE
         mpventad2 = maesprod.pventag2
      ENDIF

      IF mlista3 = "X"
         mpventad3 = ROUND(maesprod.pventag3 * (1 + mporcentaje / 100), 0)
      ELSE
         mpventad3 = maesprod.pventag3
      ENDIF

      IF mlista4 = "X"
         mpventad4 = ROUND(maesprod.pventag4 * (1 + mporcentaje / 100), 0)
      ELSE
         mpventad4 = maesprod.pventag4
      ENDIF

      IF mlista5 = "X"
         mpventad5 = ROUND(maesprod.pventag5 * (1 + mporcentaje / 100), 0)
      ELSE
         mpventad5 = maesprod.pventag5
      ENDIF

      INSERT INTO (codigo, codigo2, codorig, nombre, pventag1, pventag2, ;
       pventag3, pventag4, pventag5, pventad1, pventad2, pventad3, ;
       pventad4, pventad5) ;
         VALUES (maesprod.codigo, maesprod.codigo2, maesprod.codorig, ;
          maesprod.nombre, maesprod.pventag1, maesprod.pventag2, ;
          maesprod.pventag3, maesprod.pventag4, maesprod.pventag5, ;
          mpventad1, mpventad2, mpventad3, mpventad4, mpventad5)
   ENDIF
ENDSCAN

SELECT temporal
BROWSE

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS5W           mproveedor VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   13  є
*       є Variable:            mproveedor                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks5w     &&  mproveedor VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 28, 127)
   RETURN .F.
ELSE
   IF LASTKEY() = 27
      RETURN
   ENDIF
ENDIF

IF EMPTY(mproveedor)
   @ 01,20 SAY PADR("TODOS", 40, CHR(32)) ;
      SIZE 1,40 ;
      PICTURE "@!"
   RETURN
ENDIF

mproveedor = VAL(mproveedor)

IF mproveedor <= 0
   @ 01,20 SAY REPLICATE(CHR(32), 40) ;
      SIZE 1,40 ;
      PICTURE "@!"
   DO prov_pop.spr WITH "mproveedor", 0, .F.
ENDIF

IF mproveedor = 0
   mproveedor = LEFT(ALLTRIM(STR(mproveedor)) + SPACE(4), 4)
   RETURN .F.
ENDIF

PRIVATE pnSelect, pcOrder, pnRecNo

pnSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

SELECT proveedo
SET ORDER TO TAG indice1 OF proveedo.cdx

IF SEEK(mproveedor)
   @ 01,20 SAY PADR(ALLTRIM(proveedo.nombre), 40, CHR(32)) ;
      SIZE 1,40 ;
      PICTURE "@!"

   IF .NOT. proveedo.vigente = "S"
      WAIT WINDOW "­ CODIGO DE PROVEEDOR NO VIGENTE !"
      @ 01,20 SAY REPLICATE(CHR(32), 40) ;
         SIZE 1,40 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      mproveedor = LEFT(ALLTRIM(STR(mproveedor)) + SPACE(4), 4)

      RETURN .F.
   ENDIF

ELSE
   @ 01,20 SAY REPLICATE(CHR(32), 40) ;
      SIZE 1,40 ;
      PICTURE "@!"

   WAIT WINDOW "­ CODIGO DE PROVEEDOR INEXISTENTE !"
   DO prov_pop.spr WITH "mproveedor", 0, .F.
   SHOW GETS

   SELECT proveedo
   SET ORDER TO TAG indice1 OF proveedo.cdx

   IF SEEK(mproveedor)
      @ 01,20 SAY PADR(ALLTRIM(proveedo.nombre), 40, CHR(32)) ;
         SIZE 1,40 ;
         PICTURE "@!"

   ELSE
      @ 01,20 SAY REPLICATE(CHR(32), 40) ;
         SIZE 1,40 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      mproveedor = LEFT(ALLTRIM(STR(mproveedor)) + SPACE(4), 4)

      RETURN .F.
   ENDIF
ENDIF

SELECT (pnSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo <> 0
   GOTO RECORD pnRecNo
ENDIF

mproveedor = LEFT(ALLTRIM(STR(mproveedor)) + SPACE(4), 4)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS61           mrubro VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   14  є
*       є Variable:            mrubro                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks61     &&  mrubro VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF EMPTY(mrubro)
   @ 02,20 SAY PADR("TODOS", 30, CHR(32)) ;
      SIZE 1,30 ;
      PICTURE "@!"
   RETURN
ENDIF

mrubro = VAL(mrubro)

IF mrubro <= 0
   @ 02,20 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!"
   DO rub1_pop.spr WITH "mrubro", 0, .F.
ENDIF

IF mrubro = 0
   mrubro = LEFT(ALLTRIM(STR(mrubro)) + SPACE(4), 4)
   RETURN .F.
ENDIF

PRIVATE pnSelect, pcOrder, pnRecNo

pnSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

SELECT rubros1
SET ORDER TO TAG indice1 OF rubros1.cdx

IF SEEK(mrubro)
   @ 02,20 SAY PADR(ALLTRIM(rubros1.nombre), 30, CHR(32)) ;
      SIZE 1,30 ;
      PICTURE "@!"

   IF .NOT. rubros1.vigente
      WAIT WINDOW "­ CODIGO DE RUBRO NO VIGENTE !"
      @ 02,20 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      mrubro = LEFT(ALLTRIM(STR(mrubro)) + SPACE(4), 4)

      RETURN .F.
   ENDIF

ELSE
   @ 02,20 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!"

   WAIT WINDOW "­ CODIGO DE FAMILIA INEXISTENTE !"
   DO rub1_pop.spr WITH "mrubro", 0, .F.
   SHOW GETS

   SELECT rubros1
   SET ORDER TO TAG indice1 OF rubros1.cdx

   IF SEEK(mrubro)
      @ 02,20 SAY PADR(ALLTRIM(rubros1.nombre), 30, CHR(32)) ;
         SIZE 1,30 ;
         PICTURE "@!"

   ELSE
      @ 02,20 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      mrubro = LEFT(ALLTRIM(STR(mrubro)) + SPACE(4), 4)

      RETURN .F.
   ENDIF
ENDIF

SELECT (pnSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo <> 0
   GOTO RECORD pnRecNo
ENDIF

mrubro = LEFT(ALLTRIM(STR(mrubro)) + SPACE(4), 4)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS66           msubrubro VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   15  є
*       є Variable:            msubrubro                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks66     &&  msubrubro VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF EMPTY(msubrubro)
   @ 03,20 SAY PADR("TODOS", 30, CHR(32)) ;
      SIZE 1,30 ;
      PICTURE "@!"
   RETURN
ENDIF

msubrubro = VAL(msubrubro)

IF msubrubro <= 0
   @ 03,20 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!"
   DO rub2_pop.spr WITH "msubrubro", 0, .F.
ENDIF

IF msubrubro = 0
   msubrubro = LEFT(ALLTRIM(STR(msubrubro)) + SPACE(4), 4)
   RETURN .F.
ENDIF

PRIVATE pnSelect, pcOrder, pnRecNo

pnSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

SELECT rubros2
SET ORDER TO TAG indice1 OF rubros2.cdx

IF SEEK(msubrubro)
   @ 03,20 SAY PADR(ALLTRIM(rubros2.nombre), 30, CHR(32)) ;
      SIZE 1,30 ;
      PICTURE "@!"

   IF .NOT. rubros2.vigente
      WAIT WINDOW "­ CODIGO DE SUB-RUBRO NO VIGENTE !"
      @ 03,20 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      msubrubro = LEFT(ALLTRIM(STR(msubrubro)) + SPACE(4), 4)

      RETURN .F.
   ENDIF

ELSE
   @ 03,20 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!"

   WAIT WINDOW "­ CODIGO DE FAMILIA INEXISTENTE !"
   DO rub2_pop.spr WITH "msubrubro", 0, .F.
   SHOW GETS

   SELECT rubros2
   SET ORDER TO TAG indice1 OF rubros2.cdx

   IF SEEK(msubrubro)
      @ 03,20 SAY PADR(ALLTRIM(rubros2.nombre), 30, CHR(32)) ;
         SIZE 1,30 ;
         PICTURE "@!"

   ELSE
      @ 03,20 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      msubrubro = LEFT(ALLTRIM(STR(msubrubro)) + SPACE(4), 4)

      RETURN .F.
   ENDIF
ENDIF

SELECT (pnSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo <> 0
   GOTO RECORD pnRecNo
ENDIF

msubrubro = LEFT(ALLTRIM(STR(msubrubro)) + SPACE(4), 4)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6B           mmarca VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   16  є
*       є Variable:            mmarca                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6b     &&  mmarca VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF EMPTY(mmarca)
   @ 04,20 SAY PADR("TODAS", 30, CHR(32)) ;
      SIZE 1,30 ;
      PICTURE "@!"
   RETURN
ENDIF

mmarca = VAL(mmarca)

IF mmarca <= 0
   @ 04,20 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!"
   DO mar1_pop.spr WITH "mmarca", 0, .F.
ENDIF

IF mmarca = 0
   mmarca = LEFT(ALLTRIM(STR(mmarca)) + SPACE(4), 4)
   RETURN .F.
ENDIF

PRIVATE pnSelect, pcOrder, pnRecNo

pnSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

SELECT marcas1
SET ORDER TO TAG indice1 OF marcas1.cdx

IF SEEK(mmarca)
   @ 04,20 SAY PADR(ALLTRIM(marcas1.nombre), 30, CHR(32)) ;
      SIZE 1,30 ;
      PICTURE "@!"

   IF .NOT. marcas1.vigente
      WAIT WINDOW "­ CODIGO DE MARCA NO VIGENTE !"
      @ 04,20 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      mmarca = LEFT(ALLTRIM(STR(mmarca)) + SPACE(4), 4)

      RETURN .F.
   ENDIF

ELSE
   @ 04,20 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!"

   WAIT WINDOW "­ CODIGO DE FAMILIA INEXISTENTE !"
   DO mar1_pop.spr WITH "mmarca", 0, .F.
   SHOW GETS

   SELECT marcas1
   SET ORDER TO TAG indice1 OF marcas1.cdx

   IF SEEK(mmarca)
      @ 04,20 SAY PADR(ALLTRIM(marcas1.nombre), 30, CHR(32)) ;
         SIZE 1,30 ;
         PICTURE "@!"

   ELSE
      @ 04,20 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!"

      SELECT (pnSelect)
      SET ORDER TO TAG (pcOrder)
      IF pnRecNo <> 0
         GOTO RECORD pnRecNo
      ENDIF

      mmarca = LEFT(ALLTRIM(STR(mmarca)) + SPACE(4), 4)

      RETURN .F.
   ENDIF
ENDIF

SELECT (pnSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo <> 0
   GOTO RECORD pnRecNo
ENDIF

mmarca = LEFT(ALLTRIM(STR(mmarca)) + SPACE(4), 4)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6G           mopcion VALID                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   17  є
*       є Variable:            mopcion                            є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6g     &&  mopcion VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF .NOT. INLIST(mopcion, "1", "2")
   WAIT WINDOW "­ LA OPCION DEBE SER: 1 ў 2 !"
   RETURN .F.
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6H           mlista1 VALID                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   18  є
*       є Variable:            mlista1                            є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6h     &&  mlista1 VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF .NOT. EMPTY(mlista1)
   IF mlista1 <> "X"
      WAIT WINDOW [­ LA OPCION DEBE ESTAR MARCADA CON UNA < X > o EN BLANCO !]
      RETURN .F.
   ENDIF
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6J           mlista2 VALID                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   19  є
*       є Variable:            mlista2                            є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6j     &&  mlista2 VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF .NOT. EMPTY(mlista2)
   IF mlista2 <> "X"
      WAIT WINDOW [­ LA OPCION DEBE ESTAR MARCADA CON UNA < X > o EN BLANCO !]
      RETURN .F.
   ENDIF
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6K           mlista3 VALID                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   20  є
*       є Variable:            mlista3                            є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6k     &&  mlista3 VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF .NOT. EMPTY(mlista3)
   IF mlista3 <> "X"
      WAIT WINDOW [­ LA OPCION DEBE ESTAR MARCADA CON UNA < X > o EN BLANCO !]
      RETURN .F.
   ENDIF
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6M           mlista4 VALID                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   21  є
*       є Variable:            mlista4                            є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6m     &&  mlista4 VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF .NOT. EMPTY(mlista4)
   IF mlista4 <> "X"
      WAIT WINDOW [­ LA OPCION DEBE ESTAR MARCADA CON UNA < X > o EN BLANCO !]
      RETURN .F.
   ENDIF
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6N           mlista5 VALID                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   22  є
*       є Variable:            mlista5                            є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      10                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6n     &&  mlista5 VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF .NOT. EMPTY(mlista5)
   IF mlista5 <> "X"
      WAIT WINDOW [­ LA OPCION DEBE ESTAR MARCADA CON UNA < X > o EN BLANCO !]
      RETURN .F.
   ENDIF
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6O           mporcentaje VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   23  є
*       є Variable:            mporcentaje                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      11                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6o     &&  mporcentaje VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27, 127)
   RETURN
ENDIF

IF mporcentaje <= 0
   WAIT WINDOW "­ EL PORCENTAJE DEBE SER MAYOR QUE CERO !"
   RETURN .F.
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1CY10KS6P           cmgChoice VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         FSTPRMFY,     Record Number:   24  є
*       є Variable:            cmgChoice                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      12                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1cy10ks6p     &&  cmgChoice VALID
#REGION 1
IF cmgChoice = 1
   DO Process
ENDIF

IF cmgChoice = 2
   CLEAR READ
ENDIF