*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 08/01/2004           CUOT_POP.SPR              08:07:50 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2004 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ

DO CASE
CASE _DOS OR _UNIX      && no UNIX records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.currarea = SELECT()
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є                MS-DOS Window definitions                є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	IF NOT WEXIST("_1500hfdin")
		DEFINE WINDOW _1500hfdin ;
			FROM INT((SROW()-21)/2),INT((SCOL()-54)/2) ;
			TO INT((SROW()-21)/2)+20,INT((SCOL()-54)/2)+53 ;
			TITLE " CUOTAS DE COMPRAS " ;
			NOFLOAT ;
			NOCLOSE ;
			NOMINIMIZE ;
			COLOR SCHEME 19
	ENDIF
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є         CUOT_POP/MS-DOS Setup Code - SECTION 2          є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	#REGION 1
	PRIVATE pcCondCompra, pnEntrInicial, m.consignaci
	
	DIMENSION paQtyCuota[1]
	
	paQtyCuota    = ""
	pcCondCompra  = ""
	pnEntrInicial = 0
	m.consignaci  = "N"
	
	PUSH KEY CLEAR
	
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є              CUOT_POP/MS-DOS Screen Layout              є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	#REGION 1
	IF WVISIBLE("_1500hfdin")
		ACTIVATE WINDOW _1500hfdin SAME
	ELSE
		ACTIVATE WINDOW _1500hfdin NOSHOW
	ENDIF
	@ 4,3 SAY "Consignaciўn ?.:" ;
		SIZE 1,16, 0
	@ 3,3 SAY "Entrega Inicial:" ;
		SIZE 1,16, 0
	@ 6,1 TO 18,36
	@ 7,25 SAY "Importe" ;
		SIZE 1,7, 0
	@ 7,12 SAY "Fecha" ;
		SIZE 1,5, 0
	@ 7,4 SAY "N§" ;
		SIZE 1,2, 0
	@ 6,15 SAY " CUOTAS " ;
		SIZE 1,8, 0 ;
		COLOR W/N     
	@ 1,17 GET pnOption ;
		SIZE 1,3 ;
		DEFAULT 0 ;
		PICTURE "999" ;
		VALID _1500hfdjr()
	@ 2,17 GET pcCondCompra ;
		SIZE 1,32 ;
		DEFAULT " " ;
		PICTURE "@T" ;
		WHEN pnOption = 12 ;
		VALID _1500hfdk4()
	@ 3,20 GET pnEntrInicial ;
		SIZE 1,11 ;
		DEFAULT 0 ;
		PICTURE "999,999,999" ;
		WHEN .NOT. INLIST(pnOption, 1, 10, 11) ;
		VALID _1500hfdk9()
	@ 4,20 GET m.consignaci ;
		SIZE 1,1 ;
		DEFAULT " " ;
		PICTURE "@A!" ;
		WHEN _1500hfdkc() ;
		VALID _1500hfdkf()
	@ 8,2 GET lstQtyCuotas ;
	 	PICTURE "@&N" ;
		FROM paQtyCuota ;
		SIZE 9,34 ;
		DEFAULT 1 ;
		COLOR SCHEME 15
	@ 17,10 GET m.edit ;
		PICTURE "@*VN Modificar C\<uota" ;
		SIZE 1,19,1 ;
		DEFAULT 1 ;
		VALID _1500hfdkl()
	@ 7,38 GET m.new ;
		PICTURE "@*VN \!\<Grabar" ;
		SIZE 1,13,1 ;
		DEFAULT 1 ;
		VALID _1500hfdkq()
	@ 9,38 GET m.edit ;
		PICTURE "@*VN \<Modificar" ;
		SIZE 1,13,1 ;
		DEFAULT 1 ;
		VALID _1500hfdkx()
	@ 11,38 GET m.cancel ;
		PICTURE "@*VN \?\<Cancelar" ;
		SIZE 1,13,1 ;
		DEFAULT 1 ;
		VALID _1500hfdl2()
	@ 13,38 GET m.gethelp ;
		PICTURE "@*VN A\<yuda" ;
		SIZE 1,13,1 ;
		DEFAULT 1 ;
		VALID _1500hfdl6()
	@ 1,3 SAY "Vencimientos:" ;
		SIZE 1,13, 0
	
	IF NOT WVISIBLE("_1500hfdin")
		ACTIVATE WINDOW _1500hfdin
	ENDIF
	
	READ CYCLE ;
		SHOW _1500hfdl9()
	
	RELEASE WINDOW _1500hfdin
	SELECT (m.currarea)
	
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	

CASE _WINDOWS OR _MAC   && no MAC records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.rborder = SET("READBORDER")
	SET READBORDER OFF
	
	m.currarea = SELECT()
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є     CUOT_POP/Windows Databases, Indexes, Relations      є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	IF USED("usuarios")
		SELECT usuarios
		SET ORDER TO TAG "indice1"
	ELSE
		SELECT 0
		USE (LOCFILE("usuarios.dbf","DBF","Where is usuarios?"));
			AGAIN ALIAS usuarios ;
			ORDER TAG "indice1"
	ENDIF
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є               Windows Window definitions                є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	IF NOT WEXIST("_1500hfdm3")
		DEFINE WINDOW _1500hfdm3 ;
			AT  0.000, 0.000  ;
			SIZE 19.769,34.000 ;
			TITLE " FAMILIAS " ;
			FOOTER " Presione A-Z para Buscar " ;
			FONT "MS Sans Serif", 8 ;
			STYLE "B" ;
			NOFLOAT ;
			NOCLOSE ;
			NOMINIMIZE
		MOVE WINDOW _1500hfdm3 CENTER
	ENDIF
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є         CUOT_POP/Windows Setup Code - SECTION 2         є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	#REGION 1
	private m.count, m.choice, aFamilias
	select familias
	count to m.count
	if empty(m.count)
	   dimension aFamilias(1,2)
	   aFamilias(1,1) = 1
	   aFamilias(1,2) = "-"
	else
	   dimension aFamilias(m.count,2)
	   copy to array aFamilias fields codigo, nombre
	   =asort(aFamilias, aelement(aFamilias, 1, 2))
	endif
	on key label "F2" do familnew.spr
	
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є             CUOT_POP/Windows Screen Layout              є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	#REGION 1
	IF WVISIBLE("_1500hfdm3")
		ACTIVATE WINDOW _1500hfdm3 SAME
	ELSE
		ACTIVATE WINDOW _1500hfdm3 NOSHOW
	ENDIF
	@ 0.538,0.167 GET m.choice ;
	 	PICTURE "@&T" ;
		FROM aFamilias ;
		RANGE 2 ;
		SIZE 13.846,39.400 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8
	@ 15.000,1.000 GET m.new ;
		PICTURE "@*VN \<Nuevo" ;
		SIZE 1.769,9.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _1500hfdmi()
	@ 15.000,12.000 GET m.delete ;
		PICTURE "@*VN \<Borrar" ;
		SIZE 1.769,10.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _1500hfdml()
	@ 15.000,24.000 GET m.edit ;
		PICTURE "@*VN \<Modif." ;
		SIZE 1.769,10.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _1500hfdmo()
	@ 17.000,1.000 GET m.gethelp ;
		PICTURE "@*VN \<Ayuda" ;
		SIZE 1.769,9.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _1500hfdms()
	@ 17.000,24.000 GET m.cancel ;
		PICTURE "@*VN \?\<Salir" ;
		SIZE 1.769,10.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _1500hfdmv()
	
	IF NOT WVISIBLE("_1500hfdm3")
		ACTIVATE WINDOW _1500hfdm3
	ENDIF
	
	READ CYCLE
	
	RELEASE WINDOW _1500hfdm3
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є                Windows Closing Databases                є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	IF USED("usuarios")
		SELECT usuarios
		USE
	ENDIF
	
	SELECT (m.currarea)
	
	
	#REGION 0
	
	SET READBORDER &rborder
	
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
	*       є                                                         є
	*       є              CUOT_POP/Windows Cleanup Code              є
	*       є                                                         є
	*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
	*
	
	#REGION 1
	if lastkey() == 27
	   m.familia = 0
	   release m.count, m.choice, aFamilias
	   return
	else
	   m.maquina = aFamilias(m.choice,1)
	   release m.count, m.choice, aFamilias
	   return
	endif
	on key label "F2"

ENDCASE


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDJR           pnOption VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:    9  є
*       є Variable:            pnOption                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdjr     &&  pnOption VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27))
   RETURN .T.
ENDIF
IF pnOption <= 0
   @ 01,22 SAY REPLICATE(CHR(32),30) ;
      SIZE 1,25 ;
      PICTURE "@!" ;
      COLOR N/W
   DO cmcndcom.spr WITH "pnOption", 0, .F.
ENDIF
IF pnOption = 0
   RETURN .F.
ENDIF

DO CASE
   CASE pnOption = 1
      @ 01,22 SAY UPPER("Al Contado") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
      DO _clcCuotas
   CASE pnOption = 2
      @ 01,22 SAY UPPER("8 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 3
      @ 01,22 SAY UPPER("10 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 4
      @ 01,22 SAY UPPER("30 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 5
      @ 01,22 SAY UPPER("30/60 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 6
      @ 01,22 SAY UPPER("30/60/90 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 7
      @ 01,22 SAY UPPER("30/60/90/120 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 8
      @ 01,22 SAY UPPER("30/60/90/120/150 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 9
      @ 01,22 SAY UPPER("30/60/90/120/150/180 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   CASE pnOption = 10
      @ 01,22 SAY UPPER("Consignacion 120 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
         DO _clcCuotas
   CASE pnOption = 11
      @ 01,22 SAY UPPER("Consignacion 180 Dias") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
         DO _clcCuotas
   CASE pnOption = 12
      @ 01,22 SAY UPPER("Otras Condiciones...") ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
   OTHERWISE
      @ 01,22 SAY REPLICATE(CHR(32),30) ;
         SIZE 1,25 ;
         PICTURE "@!" ;
         COLOR N/W
      WAIT WINDOW "­ CODIGO DE CONDICION DE COMPRA INEXISTENTE !"
      DO cmcndcom.spr WITH "pnOption", pnOption, .F.
      IF pnOption = 0 .OR. pnOption > 12
         @ 01,22 SAY REPLICATE(CHR(32),30) ;
            SIZE 1,25 ;
            PICTURE "@!" ;
            COLOR N/W
         RETURN .F.
      ENDIF
ENDCASE


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDK4           pcCondCompra VALID                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   10  є
*       є Variable:            pcCondCompra                       є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdk4     &&  pcCondCompra VALID
#REGION 1
IF .NOT. EMPTY(pcCondCompra)
   FOR pnCounter = 1 TO LEN(ALLTRIM(pcCondCompra))
      IF .NOT. BETWEEN(ASC(SUBSTR(pcCondCompra, pnCounter, 1)), 47, 57)
         WAIT WINDOW "­ EXISTEN CARACTERES INVALIDOS EN LA EXPRESION !"
         WAIT WINDOW "SOLO ESTAN PERMITIDOS LOS NROS. DEL 0 AL 9 Y EL CARACTER < / >"
         RETURN .F.
      ENDIF
   ENDFOR
   DO WHILE AT("//", pcCondCompra) > 0
      pcCondCompra = STRTRAN(pcCondCompra, "//", "/")
   ENDDO
   IF SUBSTR(pcCondCompra, 1, 1) = CHR(47)
      pcCondCompra = SUBSTR(pcCondCompra, 2)
   ENDIF
   IF RIGHT(pcCondCompra, 1) = CHR(47)
      pcCondCompra = SUBSTR(pcCondCompra, 1, LEN(pcCondCompra) - 1)
   ENDIF
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDK9           pnEntrInicial VALID                є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   11  є
*       є Variable:            pnEntrInicial                      є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdk9     &&  pnEntrInicial VALID
#REGION 1
IF INLIST(LASTKEY(), 5, 19, 27))
   RETURN .T.
ENDIF
IF pnEntrInicial < 0
   WAIT WINDOW "­ LA ENTREGA INICIAL DEBE SER MAYOR O IGUAL QUE CERO !"
   RETURN .F.
ENDIF
IF .NOT. EMPTY(pnEntrInicial)
   DO _clcCuotas
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDKC           m.consignaci WHEN                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   12  є
*       є Variable:            m.consignaci                       є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdkc     &&  m.consignaci WHEN
#REGION 1
IF INLIST(pnOption, 1, 10, 11)
   RETURN .F.
ENDIF
IF .NOT. EMPTY(pnEntrInicial)
   RETURN .F.
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDKF           m.consignaci VALID                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   12  є
*       є Variable:            m.consignaci                       є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdkf     &&  m.consignaci VALID
#REGION 1
IF .NOT. INLIST(m.consignaci, "S", "N")
*  WAIT WINDOW "­ CONSIGNACION DEBE SER (S)I o (N)O !"
   WAIT WINDOW "­ CONSIGNACION DEBE SER: S/N !"
   RETURN .F.
   @ 04,23 SAY REPLICATE(CHR(32),02) ;
      SIZE 1,2 ;
      PICTURE "@!" ;
      COLOR N/W
ELSE
   IF m.consignaci = "S"
      @ 04,23 SAY UPPER("Si") ;
         SIZE 1,2 ;
         PICTURE "@!" ;
         COLOR N/W
   ELSE
      IF m.consignaci = "N"
         @ 04,23 SAY UPPER("No") ;
            SIZE 1,2 ;
            PICTURE "@!" ;
            COLOR N/W
      ENDIF
   ENDIF
ENDIF
DO _clcCuotas

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDKL           m.edit VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   14  є
*       є Variable:            m.edit                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdkl     &&  m.edit VALID
#REGION 1
PRIVATE pcSelect, pcOrder, pnRecNo

pcSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

SELECT proveedo
SET ORDER TO TAG indice1 OF proveedo.cdx

IF SEEK(aProveedor(lstProveedores,1))
   DO proveedo.prg WITH "Edit"
   _CUROBJ = OBJNUM(lstProveedores)
ENDIF

SELECT (pcSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo # 0
   GOTO RECORD pnRecNo
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDKQ           m.new VALID                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   15  є
*       є Variable:            m.new                              є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdkq     &&  m.new VALID
#REGION 1
DO proveedo.prg WITH "Add"
_CUROBJ = OBJNUM(lstProveedores)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDKX           m.edit VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   16  є
*       є Variable:            m.edit                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdkx     &&  m.edit VALID
#REGION 1
PRIVATE pcSelect, pcOrder, pnRecNo

pcSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

SELECT proveedo
SET ORDER TO TAG indice1 OF proveedo.cdx

IF SEEK(aProveedor(lstProveedores,1))
   DO proveedo.prg WITH "Edit"
   _CUROBJ = OBJNUM(lstProveedores)
ENDIF

SELECT (pcSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo # 0
   GOTO RECORD pnRecNo
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDL2           m.cancel VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   17  є
*       є Variable:            m.cancel                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdl2     &&  m.cancel VALID
#REGION 1
CLEAR READ

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDL6           m.gethelp VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP,     Record Number:   18  є
*       є Variable:            m.gethelp                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      10                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdl6     &&  m.gethelp VALID
#REGION 1
HELP ю Proveedores

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDL9           Read Level Show                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         CUOT_POP                           є
*       є Called By:           READ Statement                     є
*       є Snippet Number:      11                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdl9     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: CUOT_POP
*
#REGION 1
*IF pnCount = 0
*   SHOW GET m.delete DISABLE
*   SHOW GET m.edit   DISABLE
*ELSE
*   SHOW GET m.delete ENABLE
*   SHOW GET m.edit   ENABLE
*ENDIF

IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDMI           m.new VALID                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       Windows                            є
*       є From Screen:         CUOT_POP,     Record Number:   25  є
*       є Variable:            m.new                              є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      12                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdmi     &&  m.new VALID
#REGION 1
do familnew.spr
_curobj = objnum(m.choice)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDML           m.delete VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       Windows                            є
*       є From Screen:         CUOT_POP,     Record Number:   26  є
*       є Variable:            m.delete                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      13                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdml     &&  m.delete VALID
#REGION 1
HELP SET LOCK

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDMO           m.edit VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       Windows                            є
*       є From Screen:         CUOT_POP,     Record Number:   27  є
*       є Variable:            m.edit                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      14                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdmo     &&  m.edit VALID
#REGION 1
HELP ю Familia

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDMS           m.gethelp VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       Windows                            є
*       є From Screen:         CUOT_POP,     Record Number:   28  є
*       є Variable:            m.gethelp                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      15                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdms     &&  m.gethelp VALID
#REGION 1
HELP ю Familia

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _1500HFDMV           m.cancel VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       Windows                            є
*       є From Screen:         CUOT_POP,     Record Number:   29  є
*       є Variable:            m.cancel                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      16                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _1500hfdmv     &&  m.cancel VALID
#REGION 1
clear read


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є  CUOT_POP/Windows Supporting Procedures and Functions   є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              CUOT_POP Function _CLCCUOTAS               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

FUNCTION _CLCCUOTAS
DO CASE
   CASE pnOption = 1
      pcCondCompra  = ""
      pnEntrInicial = 0
      m.consignaci  = "N"
   CASE INLIST(pnOption, 2, 3, 4, 5, 6, 7, 8, 9, 12)
      m.consignaci  = "N"
   CASE INLIST(pnOption, 10, 11)
      pcCondCompra  = ""
      pnEntrInicial = 0
      m.consignaci  = "S"
ENDCASE
DO CASE
   CASE pnOption = 1
      DIMENSION paQtyCuota[1]
      paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(m.monto_fact, "999,999,999")
   CASE pnOption = 2
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[2]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+8) +  " і " + TRANSFORM(m.monto_fact - pnEntrInicial, "999,999,999")
      ELSE
         DIMENSION paQtyCuota[1]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+8) +  " і " + TRANSFORM(m.monto_fact, "999,999,999")
      ENDIF
   CASE pnOption = 3
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[2]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+10) +  " і " + TRANSFORM(m.monto_fact - pnEntrInicial, "999,999,999")
      ELSE
         DIMENSION paQtyCuota[1]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+10) +  " і " + TRANSFORM(m.monto_fact, "999,999,999")
      ENDIF
   CASE pnOption = 4
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[2]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(m.monto_fact - pnEntrInicial, "999,999,999")
      ELSE
         DIMENSION paQtyCuota[1]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(m.monto_fact, "999,999,999")
      ENDIF
   CASE pnOption = 5
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[3]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/2), "999,999,999")

         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(ROUND(((m.monto_fact - pnEntrInicial)/2),0), "999,999,999")
      ELSE
         DIMENSION paQtyCuota[2]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT(m.monto_fact/2), "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(ROUND(m.monto_fact/2,0), "999,999,999")
      ENDIF
   CASE pnOption = 6
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[4]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/3), "999,999,999")

         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/3), "999,999,999")

         paQtyCuota[4] = STR(4, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact - pnEntrInicial)/3) * 2 - pnEntrInicial, "999,999,999")
      ELSE
         DIMENSION paQtyCuota[3]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT(m.monto_fact/3), "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT(m.monto_fact/3), "999,999,999")

         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact)/3)*2, "999,999,999")
      ENDIF
   CASE pnOption = 7
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[5]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/4), "999,999,999")

         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/4), "999,999,999")

         paQtyCuota[4] = STR(4, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/4), "999,999,999")

         paQtyCuota[5] = STR(5, 3) + " і " + DTOC(CTOD(m.fechadocu)+120) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact - pnEntrInicial)/4) * 3 - pnEntrInicial, "999,999,999")
      ELSE
         DIMENSION paQtyCuota[4]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT(m.monto_fact/4), "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT(m.monto_fact/4), "999,999,999")

         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(INT(m.monto_fact/4), "999,999,999")

         paQtyCuota[4] = STR(4, 3) + " і " + DTOC(CTOD(m.fechadocu)+120) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact)/4)*3, "999,999,999")
      ENDIF
   CASE pnOption = 8
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[6]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/5), "999,999,999")

         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/5), "999,999,999")

         paQtyCuota[4] = STR(4, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/5), "999,999,999")

         paQtyCuota[5] = STR(5, 3) + " і " + DTOC(CTOD(m.fechadocu)+120) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/5), "999,999,999")

         paQtyCuota[6] = STR(6, 3) + " і " + DTOC(CTOD(m.fechadocu)+150) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact - pnEntrInicial)/5) * 4 - pnEntrInicial, "999,999,999")
      ELSE
         DIMENSION paQtyCuota[5]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT(m.monto_fact/5), "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT(m.monto_fact/5), "999,999,999")


         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(INT(m.monto_fact/5), "999,999,999")

         paQtyCuota[4] = STR(4, 3) + " і " + DTOC(CTOD(m.fechadocu)+120) +  " і " + TRANSFORM(INT(m.monto_fact/5), "999,999,999")

         paQtyCuota[5] = STR(5, 3) + " і " + DTOC(CTOD(m.fechadocu)+150) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact)/5)*4, "999,999,999")
      ENDIF
   CASE pnOption = 9
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[7]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/6), "999,999,999")

         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/6), "999,999,999")

         paQtyCuota[4] = STR(4, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/6), "999,999,999")

         paQtyCuota[5] = STR(5, 3) + " і " + DTOC(CTOD(m.fechadocu)+120) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/6), "999,999,999")

         paQtyCuota[6] = STR(6, 3) + " і " + DTOC(CTOD(m.fechadocu)+150) +  " і " + TRANSFORM(INT((m.monto_fact - pnEntrInicial)/6), "999,999,999")

         paQtyCuota[7] = STR(7, 3) + " і " + DTOC(CTOD(m.fechadocu)+180) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact - pnEntrInicial)/6) * 5 - pnEntrInicial, "999,999,999")
      ELSE
         DIMENSION paQtyCuota[6]

         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+30) +  " і " + TRANSFORM(INT(m.monto_fact/6), "999,999,999")

         paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+60) +  " і " + TRANSFORM(INT(m.monto_fact/6), "999,999,999")


         paQtyCuota[3] = STR(3, 3) + " і " + DTOC(CTOD(m.fechadocu)+90) +  " і " + TRANSFORM(INT(m.monto_fact/6), "999,999,999")

         paQtyCuota[4] = STR(4, 3) + " і " + DTOC(CTOD(m.fechadocu)+120) +  " і " + TRANSFORM(INT(m.monto_fact/6), "999,999,999")

         paQtyCuota[5] = STR(5, 3) + " і " + DTOC(CTOD(m.fechadocu)+150) +  " і " + TRANSFORM(INT(m.monto_fact/6), "999,999,999")

         paQtyCuota[6] = STR(6, 3) + " і " + DTOC(CTOD(m.fechadocu)+180) +  " і " + TRANSFORM(m.monto_fact - INT((m.monto_fact)/6)*5, "999,999,999")
      ENDIF
   CASE pnOption = 10
      DIMENSION paQtyCuota[1]

      paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+120) +  " і " + TRANSFORM(m.monto_fact, "999,999,999")
   CASE pnOption = 11
      DIMENSION paQtyCuota[1]

      paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+180) +  " і " + TRANSFORM(m.monto_fact, "999,999,999")
   CASE pnOption = 12
      IF OCCURS("/", pcCondCompra) = 0
         IF pnEntrInicial > 0
            DIMENSION paQtyCuota[2]

            paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")

            paQtyCuota[2] = STR(2, 3) + " і " + DTOC(CTOD(m.fechadocu)+VAL(pcCondCOmpra)) +  " і " + TRANSFORM(m.monto_fact - pnEntrInicial, "999,999,999")
            SHOW GETS
            RETURN
         ELSE
            DIMENSION paQtyCuota[1]

            paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)+VAL(pcCondCOmpra)) +  " і " + TRANSFORM(m.monto_fact, "999,999,999")
            SHOW GETS
            RETURN
         ENDIF
      ENDIF
      PRIVATE pnCounter, paPlazos
      IF .NOT. EMPTY(pcCondCompra)
         FOR pnCounter = 1 TO LEN(ALLTRIM(pcCondCompra))
            IF .NOT. BETWEEN(ASC(SUBSTR(pcCondCompra, pnCounter, 1)), 47, 57)
               WAIT WINDOW "­ EXISTEN CARACTERES INVALIDOS EN LA EXPRESION !"
               WAIT WINDOW "SOLO ESTAN PERMITIDOS LOS NROS. DEL 0 AL 9 Y EL CARACTER < / >"
               RETURN .F.
            ENDIF
         ENDFOR
         DO WHILE AT("//", pcCondCompra) > 0
            pcCondCompra = STRTRAN(pcCondCompra, "//", "/")
         ENDDO
         IF SUBSTR(pcCondCompra, 1, 1) = CHR(47)
            pcCondCompra = SUBSTR(pcCondCompra, 2)
         ENDIF
         IF RIGHT(pcCondCompra, 1) = CHR(47)
            pcCondCompra = SUBSTR(pcCondCompra, 1, LEN(pcCondCompra) - 1)
         ENDIF
      ENDIF

      DIMENSION paPlazos[OCCURS("/", pcCondCompra) + 1]
      FOR pnCounter = 1 to OCCURS("/", pcCondCompra) + 1
         IF pnCounter = 1
            paPlazos[pnCounter] = SUBSTR(pcCondCompra, 1, AT("/", pcCondCompra) - 1)
         ELSE
            IF pnCounter < OCCURS("/", pcCondCompra) + 1
               paPlazos[pnCounter] = SUBSTR(pcCondCompra, AT("/", pcCondCompra, pnCounter - 1) + 1, (AT("/", pcCondCompra, pnCounter) - 1) - AT("/", pcCondCompra, pnCounter - 1))
            ELSE
               paPlazos[pnCounter] = RIGHT(pcCondCompra, LEN(pcCondCompra) -  RAT("/", pcCondCompra, 1))
            ENDIF
         ENDIF
      ENDFOR
      FOR pnCounter = 1 TO ALEN(paPlazos) - 1
         IF VAL(paPlazos[pnCounter]) >  VAL(paPlazos[pnCounter+1])
            WAIT WINDOW "­ VERIFIQUE EL PLAZO DE LOS VENCIMIENTOS !"
            RETURN .F.
         ENDIF
      ENDFOR
      IF pnEntrInicial > 0
         DIMENSION paQtyCuota[ALEN(paPlazos)+1]
         paQtyCuota[1] = STR(1, 3) + " і " + DTOC(CTOD(m.fechadocu)) +  " і " + TRANSFORM(pnEntrInicial, "999,999,999")
         FOR pnCounter = 1 TO ALEN(paPlazos)
            IF pnCounter # ALEN(paPlazos)
               paQtyCuota[pnCounter+1] = STR(pnCounter+1, 3) + " і " + DTOC(CTOD(m.fechadocu) + VAL(paPlazos(pnCounter))) +  " і " + TRANSFORM(INT((m.monto_fact-pnEntrInicial)/ALEN(paPlazos)), "999,999,999")
            ELSE
 
 WAIT WINDOW STR((m.monto_fact - pnEntrInicial - (INT((m.monto_fact-pnEntrInicial)/ALEN(paPlazos))*(ALEN(paPlazos)-1))))
                paQtyCuota[pnCounter+1] = STR(pnCounter+1, 3) + " і " + DTOC(CTOD(m.fechadocu) + VAL(paPlazos(pnCounter))) +  " і " + STR((m.monto_fact - pnEntrInicial - (INT((m.monto_fact-pnEntrInicial)/ALEN(paPlazos))*(ALEN(paPlazos)-1))))
*               paQtyCuota[pnCounter+1] = STR(pnCounter+1, 3) + " і " + DTOC(CTOD(m.fechadocu) + VAL(paPlazos(pnCounter))) +  " і " + TRANSFORM((m.monto_fact - INT((m.monto_fact-pnEntrInicial)/ALEN(paPlazos))*(ALEN(paPlazos)-1) - pnEntrInicial), "999,999,999")
            ENDIF
         ENDFOR
      ELSE
         DIMENSION paQtyCuota[ALEN(paPlazos)]
         FOR pnCounter = 1 TO ALEN(paPlazos)
            IF pnCounter # ALEN(paPlazos)
               paQtyCuota[pnCounter] = STR(pnCounter, 3) + " і " + DTOC(CTOD(m.fechadocu) + VAL(paPlazos(pnCounter))) +  " і " + TRANSFORM(INT(m.monto_fact/ALEN(paPlazos)), "999,999,999")
            ELSE
               paQtyCuota[pnCounter] = STR(pnCounter, 3) + " і " + DTOC(CTOD(m.fechadocu) + VAL(paPlazos(pnCounter))) +  " і " + TRANSFORM(m.monto_fact - INT(m.monto_fact/ALEN(paPlazos)*(ALEN(paPlazos)-1)), "999,999,999")
            ENDIF
         ENDFOR
      ENDIF
ENDCASE
SHOW GETS


IF m.consignaci = "S"
   @ 04,23 SAY UPPER("Si") ;
      SIZE 1,2 ;
      PICTURE "@!" ;
      COLOR N/W
ELSE
   IF m.consignaci = "N"
      @ 04,23 SAY UPPER("No") ;
         SIZE 1,2 ;
         PICTURE "@!" ;
         COLOR N/W
   ENDIF
ENDIF
