*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        05/09/04               OT1C.PRG                09:52:17 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2004 Alben S.R.L.                         
*        Avda. Eusebio Ayala N 5095 e/Mec쟮icos de Aviaci줻.    
*        Asunci줻, Paraguay                                      
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

m.currarea = SELECT()


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF .NOT. WEXIST("_18e0l5p5w")
   DEFINE WINDOW _18e0l5p5w ;
      FROM 1, 0 ;
      TO 23,79 ;
      TITLE " CONSULTAR ORDEN DE TRABAJO " ;
      NOFLOAT ;
      NOCLOSE ;
      SHADOW ;
      NOMINIMIZE ;
      COLOR "W+/B,GR+/RB,GR+/B,GR+/B,R+/B,W+/GR,GR+/RB,,," 
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                   OT1/MS-DOS Setup Code - SECTION 2            
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

PUSH KEY CLEAR

PRIVATE pcCursor

IF SET("CURSOR") = "ON"
   pcCursor = "ON"
   SET CURSOR OFF
ELSE
   pcCursor = "OFF"
ENDIF

SCATTER MEMVAR MEMO

*-- Obtiene la fecha de terminaci줻 y el importe total del movimiento.
pnSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

SELECT cabemot
SET ORDER TO TAG indice1 OF cabemot.cdx

IF SEEK(STR(2, 1) + m.serie + STR(m.nroot, 7))
   m.fecha      = cabemot.fecha
   m.monto_fact = cabemot.monto_fact
ELSE
   m.fecha = {  /  /    }
   m.monto_fact = 0
ENDIF

SELECT (pnSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo <> 0
   GOTO RECORD pnRecNo
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       OT1/MS-DOS Screen Layout                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("_18e0l5p5w")
	ACTIVATE WINDOW _18e0l5p5w SAME
ELSE
	ACTIVATE WINDOW _18e0l5p5w NOSHOW
ENDIF
@ 10,44 SAY "Barrio:" ;
   SIZE 1,7, 0 ;
   COLOR BG+/B	
@ 9,2 SAY "Departamen.:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 1,33 SAY "M괹anico:" ;
   SIZE 1,9, 0 ;
   COLOR BG+/B	   
@ 14,42 SAY "Color.:" ;
   SIZE 1,7, 0 ;
   COLOR BG+/B	   
@ 15,2 SAY "Accesorio..:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B		
@ 20,2 SAY "Estado de la OT:" ;
   SIZE 1,16, 0 ;
   COLOR BG+/B	   
@ 16,2 SAY "Trabajo....:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 19,0 TO 19,77 ;
   COLOR GR+/B
@ 14,67 SAY "Km:" ;
   SIZE 1,3, 0 ;
   COLOR BG+/B	   
@ 14,2 SAY "Chapa N...:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 13,42 SAY "Chasis:" ;
   SIZE 1,7, 0 ;
   COLOR BG+/B	   
@ 13,2 SAY "Motor N...:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 11,0 TO 11,77 ;
   COLOR GR+/B
@ 8,56 SAY "Doc.Id.:" ;
   SIZE 1,8, 0 ;
   COLOR BG+/B	   
@ 10,2 SAY "Ciudad.....:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 8,2 SAY "Tel괽ono...:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 7,2 SAY "Direcci줻..: " ;
   SIZE 1,13, 0 ;
   COLOR BG+/B	   
@ 6,2 SAY "Contacto...: " ;
   SIZE 1,13, 0 ;
   COLOR BG+/B	   
@ 5,2 SAY "Cliente....:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 0,63 SAY "/" ;
   SIZE 1,1, 0 ;
   COLOR BG+/B	   
@ 0,50 SAY "Factura N:" ;
   SIZE 1,11, 0 ;
   COLOR BG+/B	   
@ 4,0 TO 4,77 ;
   COLOR GR+/B
@ 3,51 SAY "Entregado: " ;
   SIZE 1,11, 0 ;
   COLOR BG+/B	   
@ 3,27 SAY "Prometido:" ;
   SIZE 1,10, 0 ;
   COLOR BG+/B	   
@ 2,27 SAY "Recepci줻:" ;
   SIZE 1,10, 0 ;
   COLOR BG+/B	   
@ 2,2 SAY "Referencia.:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 1,2 SAY "Local Rep..:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 0,2 SAY "OT N......:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 0,15 SAY m.serie ;
	SIZE 1,1 ;
	PICTURE "@A!" ;
	COLOR W+/BG     
@ 0,18 SAY m.nroot ;
	SIZE 1,7 ;
	PICTURE "9999999" ;
	COLOR W+/BG     
@ 0,62 SAY m.tipodocu ;
	SIZE 1,1 ;
	PICTURE "9" ;
	COLOR W+/BG     
@ 0,64 SAY m.nrodocu ;
	SIZE 1,7 ;
	PICTURE "9999999" ;
	COLOR W+/BG     
@ 1,15 SAY m.localrep ;
	SIZE 1,2 ;
	PICTURE "99" ;
	COLOR W+/BG     
@ 1,43 SAY m.mecanico ;
	SIZE 1,3 ;
	PICTURE "999" ;
	COLOR W+/BG     
@ 2,15 SAY m.referencia ;
	SIZE 1,10 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 2,38 SAY m.frecepcion ;
	SIZE 1,10 ;
	COLOR W+/BG     
@ 2,62 SAY m.fecha ;
	SIZE 1,10 ;
	COLOR W+/BG     
@ 3,38 SAY m.fpentrega ;
	SIZE 1,10 ;
	COLOR W+/BG     
@ 3,62 SAY m.fentrega ;
	SIZE 1,10 ;
	COLOR W+/BG     
@ 5,15 SAY m.cliente ;
	SIZE 1,5 ;
	PICTURE "99999" ;
	COLOR W+/BG     
@ 5,22 SAY m.nombreot ;
	SIZE 1,40 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 6,15 SAY m.contacto ;
	SIZE 1,40 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 7,15 SAY m.direcot ;
	SIZE 1,40 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 8,15 SAY m.telefot ;
	SIZE 1,40 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 8,65 SAY m.cedulaot ;
	SIZE 1,10 ;
	PICTURE "@! 9999999999" ;
	COLOR W+/BG
@ 9,15 SAY m.departamen ;
	SIZE 1,3 ;
	PICTURE "999" ;
	COLOR W+/BG     
@ 10,15 SAY m.ciudad ;
	SIZE 1,5 ;
	COLOR W+/BG     
@ 10,52 SAY m.barrio ;
	SIZE 1,4 ;
	PICTURE "9999" ;
	COLOR W+/BG     
@ 12,15 SAY m.maquina ;
	SIZE 1,3 ;
	PICTURE "999" ;
	COLOR W+/BG     
@ 12,36 SAY m.marca ;
	SIZE 1,4 ;
	PICTURE "9999" ;
	COLOR W+/BG     
@ 12,57 SAY m.modelo ;
	SIZE 1,4 ;
	PICTURE "9999" ;
	COLOR W+/BG     
@ 13,15 SAY m.motor ;
	SIZE 1,25 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 13,50 SAY m.chasis ;
	SIZE 1,25 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 14,15 SAY m.chapa ;
	SIZE 1,25 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 14,50 SAY m.color ;
	SIZE 1,15 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 14,71 SAY m.km ;
	SIZE 1,7 ;
	PICTURE "9999999" ;
	COLOR W+/BG     
@ 15,15 SAY m.accesorio ;
	SIZE 1,56 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 16,15 SAY m.trabajo1 ;
	SIZE 1,60 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 17,15 SAY m.trabajo2 ;
	SIZE 1,60 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 18,15 SAY m.trabajo3 ;
	SIZE 1,60 ;
	PICTURE "@!" ;
	COLOR W+/BG     
@ 20,19 SAY m.estadoot ;
	SIZE 1,3 ;
	PICTURE "999" ;
	COLOR W+/BG     
@ 20,50 SAY "TOTAL M.O.T.:" ;
   SIZE 1,13, 0 ;
   COLOR BG+/B	   
@ 12,2 SAY "M쟱uina....:" ;
   SIZE 1,12, 0 ;
   COLOR BG+/B	   
@ 2,51 SAY "Terminado:" ;
   SIZE 1,10, 0 ;
   COLOR BG+/B	 
@ 20,64 SAY m.monto_fact ;
	SIZE 1,11 ;
	PICTURE "999,999,999" ;
	COLOR W+/BG     

IF NOT WVISIBLE("_18e0l5p5w")
	ACTIVATE WINDOW _18e0l5p5w
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*              MS-DOSREAD contains clauses from SCREEN ot1       
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

READ CYCLE ;
   WHEN _18e0peo3y() ;
   MODAL TIMEOUT 0

RELEASE WINDOW _18e0l5p5w
SELECT (m.currarea)


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                        OT1/MS-DOS Cleanup Code                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
POP KEY
IF pcCursor = "ON"
   SET CURSOR ON
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _18E0PEO3Y           Read Level When                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         OT1                                
*        Called By:           READ Statement                     
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _18e0peo3y     && Read Level When
*
* When Code from screen: OT1
*
#REGION 1
PRIVATE pnSelect, pcOrder, pnRecNo

pnSelect = SELECT()
pcOrder  = ORDER()
pnRecNo  = IIF(EOF(), 0, RECNO())

*-- Imprime el nombre del local.
IF m.localrep <> 0
   SELECT locales  
   SET ORDER TO indice1 OF locales.cdx

   IF SEEK(m.localrep)
      @ 01,19 SAY PADR(ALLTRIM(locales.nombre), 12, CHR(32)) ;
         SIZE 1,12 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 01,19 SAY REPLICATE(CHR(32), 12) ;
         SIZE 1,12 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 01,19 SAY REPLICATE(CHR(32), 12) ;
      SIZE 1,12 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre del mec쟮ico.
IF m.mecanico <> 0
   SELECT mecanico 
   SET ORDER TO indice1 OF mecanico.cdx

   IF SEEK(m.mecanico)
      @ 01,48 SAY PADR(ALLTRIM(mecanico.nombre), 30, CHR(32)) ;
         SIZE 1,30 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 01,48 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 01,48 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre del departamento.
IF m.departamen <> 0
   SELECT depar
   SET ORDER TO indice1 OF depar.cdx

   IF SEEK(m.departamen)
      @ 09,22 SAY PADR(ALLTRIM(depar.nombre), 30, CHR(32)) ;
         SIZE 1,30 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 09,22 SAY REPLICATE(CHR(32), 30) ;
         SIZE 1,30 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 09,22 SAY REPLICATE(CHR(32), 30) ;
      SIZE 1,30 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre de la ciudad.
IF m.ciudad <> 0
   SELECT ciudades
   SET ORDER TO indice1 OF ciudades.cdx

   IF SEEK(m.ciudad)
      @ 10,22 SAY PADR(ALLTRIM(ciudades.nombre), 20, CHR(32)) ;
         SIZE 1,20 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 10,22 SAY REPLICATE(CHR(32), 20) ;
         SIZE 1,20 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 10,22 SAY REPLICATE(CHR(32), 20) ;
      SIZE 1,20 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre del barrio.
IF m.barrio <> 0
   SELECT barrios
   SET ORDER TO indice1 OF barrios.cdx

      IF SEEK(m.barrio)
      @ 10,58 SAY PADR(ALLTRIM(barrios.nombre), 19, CHR(32)) ;
         SIZE 1,19 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 10,58 SAY REPLICATE(CHR(32), 19) ;
         SIZE 1,19 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 10,58 SAY REPLICATE(CHR(32), 19) ;
      SIZE 1,19 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre de la m쟱uina.
IF m.maquina <> 0
   SELECT maquinas
   SET ORDER TO indice1 OF maquinas.cdx

   IF SEEK(m.maquina)
      @ 12,20 SAY PADR(ALLTRIM(maquinas.nombre), 14, CHR(32)) ;
         SIZE 1,14 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 12,20 SAY REPLICATE(CHR(32), 14) ;
         SIZE 1,14 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 12,20 SAY REPLICATE(CHR(32), 14) ;
      SIZE 1,14 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre de la marca.
IF m.marca <> 0
   SELECT marcas2
   SET ORDER TO indice1 OF marcas2.cdx

   IF SEEK(m.marca)
      @ 12,42 SAY PADR(ALLTRIM(marcas2.nombre), 13, CHR(32)) ;
         SIZE 1,13 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 12,42 SAY REPLICATE(CHR(32), 13) ;
         SIZE 1,13 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 12,42 SAY REPLICATE(CHR(32), 13) ;
      SIZE 1,13 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre del modelo.
IF m.modelo <> 0
   SELECT modelos
   SET ORDER TO indice1 OF modelos.cdx

   IF SEEK(m.modelo)
      @ 12,63 SAY PADR(ALLTRIM(modelos.nombre), 13, CHR(32)) ;
         SIZE 1,13 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 12,63 SAY REPLICATE(CHR(32), 13) ;
         SIZE 1,13 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 12,63 SAY REPLICATE(CHR(32), 13) ;
      SIZE 1,13 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

*-- Imprime el nombre del estado de la ot.
IF m.estadoot <> 0
   SELECT estadoot
   SET ORDER TO indice1 OF estadoot.cdx

   IF SEEK(m.estadoot)
      @ 20,24 SAY PADR(ALLTRIM(estadoot.nombre), 24, CHR(32)) ;
         SIZE 1,24 ;
         PICTURE "@!" ;
         COLOR W+/B
   ELSE
      @ 20,24 SAY REPLICATE(CHR(32), 24) ;
         SIZE 1,24 ;
         PICTURE "@!" ;
         COLOR W+/B
   ENDIF
ELSE
   @ 20,24 SAY REPLICATE(CHR(32), 24) ;
      SIZE 1,24 ;
      PICTURE "@!" ;
      COLOR W+/B
ENDIF

SELECT (pnSelect)
SET ORDER TO TAG (pcOrder)
IF pnRecNo <> 0
   GOTO RECORD pnRecNo
ENDIF